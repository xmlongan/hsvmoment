
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Building Blocks API &#8212; hsvmoment 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="One-Factor SV" href="1fsv.html" />
    <link rel="prev" title="hsvmoment.cpp_mmnt" href="generated/hsvmoment.cpp_mmnt.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="building-blocks-api">
<h1>Building Blocks API<a class="headerlink" href="#building-blocks-api" title="Permalink to this heading">¶</a></h1>
<section id="module-hsvmoment.poly">
<span id="class-poly"></span><h2>Class Poly<a class="headerlink" href="#module-hsvmoment.poly" title="Permalink to this heading">¶</a></h2>
<p>Class Poly derived from <code class="code docutils literal notranslate"><span class="pre">UserDict</span></code></p>
<p>I defined a new class <code class="code docutils literal notranslate"><span class="pre">Poly</span></code> to extend <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.UserDict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserDict</span></code></a> 
in Python Standard Library <code class="code docutils literal notranslate"><span class="pre">collections</span></code>.</p>
<p>I defined an attribute <a class="reference internal" href="#hsvmoment.poly.Poly.keyfor" title="hsvmoment.poly.Poly.keyfor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">keyfor</span></code></a> for class 
<a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>.
I also defined following magic methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Magic Method</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__add__()</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">poly1</span> <span class="pre">+</span> <span class="pre">poly2</span></code></p></td>
<td><p>Add another poly with the same keyfor</p></td>
</tr>
<tr class="row-odd"><td><p>__sub__()</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">poly1</span> <span class="pre">-</span> <span class="pre">poly2</span></code></p></td>
<td><p>subtract another poly with the same keyfor</p></td>
</tr>
<tr class="row-even"><td><p>__mul__()</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">poly1</span> <span class="pre">*</span> <span class="pre">poly2</span></code></p></td>
<td><p>Multiply with another poly with the same keyfor</p></td>
</tr>
<tr class="row-odd"><td><p>__rmul__()</p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">c</span> <span class="pre">*</span> <span class="pre">poly2</span></code></p></td>
<td><p>Reversely multiply a constant</p></td>
</tr>
</tbody>
</table>
<p>Besides, I defined following methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.merge" title="hsvmoment.poly.Poly.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">merge()</span></code></a></p></td>
<td><p>Merge with another poly with same keyfor</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.add_keyval" title="hsvmoment.poly.Poly.add_keyval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_keyval()</span></code></a></p></td>
<td><p>Insert a new key-val or add val to the existing key</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.remove_zero" title="hsvmoment.poly.Poly.remove_zero"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_zero()</span></code></a></p></td>
<td><p>Remove any item with 0 value</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.set_keyfor" title="hsvmoment.poly.Poly.set_keyfor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_keyfor()</span></code></a></p></td>
<td><p>Set the <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> attribute for the poly</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.mul_poly" title="hsvmoment.poly.Poly.mul_poly"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mul_poly()</span></code></a></p></td>
<td><p>Multiply with other poly and return a new poly</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hsvmoment.poly.Poly.is_exact_type" title="hsvmoment.poly.Poly.is_exact_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_exact_type()</span></code></a></p></td>
<td><p>Check whether the supplied argument is a Poly with the same keyfor</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hsvmoment.poly.</span></span><span class="sig-name descname"><span class="pre">Poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for different versions of “Polynomial”</p>
<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.add_keyval">
<span class="sig-name descname"><span class="pre">add_keyval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.add_keyval" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a new key-val or add val to the existing key</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – key for the poly, a tuple.</p></li>
<li><p><strong>val</strong> – corresponding value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.is_exact_type">
<span class="sig-name descname"><span class="pre">is_exact_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.is_exact_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the supplied argument is a Poly with the same keyfor</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.keyfor">
<span class="sig-name descname"><span class="pre">keyfor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#hsvmoment.poly.Poly.keyfor" title="Permalink to this definition">¶</a></dt>
<dd><p>attribute Poly.keyfor: purpose for each key component, a tuple of str.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge another poly with the same keyfor</p>
<p>Insert new key-value or add value for the existing key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> – poly with the same keyfor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated first poly.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.mul_poly">
<span class="sig-name descname"><span class="pre">mul_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyIndexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyfor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.mul_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply with a different poly and return a new poly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – another poly with different ‘keyfor’ attribute.</p></li>
<li><p><strong>keyIndexes</strong> – a tuple with two lists, 
keyIndexes[0] for self, 
keyIndexes[1] for other.</p></li>
<li><p><strong>keyfor</strong> – the ‘keyfor’ for the returned poly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a poly with ‘keyfor’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.remove_zero">
<span class="sig-name descname"><span class="pre">remove_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.remove_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any item with 0 value</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hsvmoment.poly.Poly.set_keyfor">
<span class="sig-name descname"><span class="pre">set_keyfor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.Poly.set_keyfor" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> attribute for the poly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> – a sequence of names, 
each corresponding to the key tuple counterpart,
i.e., names[i] v.s. key[i].</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.poly.kv">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.poly.</span></span><span class="sig-name descname"><span class="pre">kv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.poly.kv" title="Permalink to this definition">¶</a></dt>
<dd><p>get key[i] where key is a tuple</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – index of key or -1 for not having the element.</p></li>
<li><p><strong>key</strong> – tuple as a key for Poly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>key[i] if i in range(len(k)), otherwise 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-hsvmoment.ito_mmnt">
<span id="one-srd"></span><h2>One <abbr title="Square-Root Diffusion">SRD</abbr><a class="headerlink" href="#module-hsvmoment.ito_mmnt" title="Permalink to this heading">¶</a></h2>
<p>Itô process moment under One Square-Root Diffusion Processes</p>
<p>The content has also been explained in <a class="reference internal" href="design.html"><span class="doc">Program Design</span></a> page.</p>
<section id="insights">
<h3>Insights<a class="headerlink" href="#insights" title="Permalink to this heading">¶</a></h3>
<p>All <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span> can be represented as
a “Polynomial” of following form</p>
<div class="math notranslate nohighlight" id="polynomial-representation">
\[\begin{split}&amp;E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\\
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{n_3k(n-1)h} e^{ik[t-(n-1)h]}
[t-(n-1)h]^jv_{n-1}^l k^{-o}\theta^p\sigma_v^q\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(b_{ijlopq}\)</span> is the coefficient. 
<span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span> can be 
represented similarly.</p>
<p>To facilitate the representation and corresponding operations, I designed
a new <em>class</em> <a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a> which is derived from 
<a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.UserDict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserDict</span></code></a> in the Python Standard Library 
<a class="reference external" href="https://docs.python.org/3/library/collections.html">collections</a>.</p>
</section>
<section id="integrals">
<h3>Integrals<a class="headerlink" href="#integrals" title="Permalink to this heading">¶</a></h3>
<p>The essential computation in recursive equations <a class="reference internal" href="theory.html#equation-ito-moment-i">(3)</a> 
and <a class="reference internal" href="theory.html#equation-ito-moment-ii">(4)</a> of <a class="reference internal" href="theory.html"><span class="doc">Theory</span></a> is that of following integral</p>
<div class="math notranslate nohighlight">
\[\int_{(n-1)h}^t e^{ik[s-(n-1)h]} [s-(n-1)h]^j ds.\]</div>
<p>For the indefinite integral, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int e^{nkt} t^m dt =
\begin{cases}
\sum_{i=0}^m c_{nmi} \frac{1}{k^{i+1}}e^{nkt} t^{m-i} 
 &amp; \text{if } n\neq 0, m \neq 0,\\
\frac{1}{nk}e^{nkt}t^0 &amp; \text{if } n\neq 0, m = 0,\\
\frac{1}{m+1}e^{0kt}t^{m+1} &amp; \text{if } n = 0, m \neq 0,\\
e^{0kt}t^1 &amp; \text{if } n =0 , m=0,
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{nm0} \triangleq \frac{1}{n}\)</span> and</p>
<div class="math notranslate nohighlight">
\[c_{nmi} \triangleq \frac{(-1)^{i}}{n^{i+1}} \prod_{j=m-i+1}^{m} j,
\quad 1\le i \le m.\]</div>
<p>The coefficient <span class="math notranslate nohighlight">\(c_{nmi}\)</span> is implemented in function
<a class="reference internal" href="#hsvmoment.ito_mmnt.c_nmi" title="hsvmoment.ito_mmnt.c_nmi"><code class="xref py py-func docutils literal notranslate"><span class="pre">c_nmi()</span></code></a> which returns <a class="reference external" href="https://docs.python.org/3/library/fractions.html#fractions.Fraction" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fractions.Fraction</span></code></a>
instead of decimal (float number).</p>
<p>For the definite integral,</p>
<div class="math notranslate nohighlight">
\[\int_{(n-1)h}^t e^{ik[s-(n-1)h]}[s-(n-1)h]^jds = F(t-(n-1)h) - F(0)\]</div>
<p>where <span class="math notranslate nohighlight">\(F(t) = \int e^{nkt} t^m dt\)</span>. The definite integral is implemented 
in <a class="reference internal" href="#hsvmoment.ito_mmnt.int_et" title="hsvmoment.ito_mmnt.int_et"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_et()</span></code></a>.</p>
<section id="id1">
<h4>Polynomial Representation<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<p>The result of the integral, returned by <a class="reference internal" href="#hsvmoment.ito_mmnt.int_et" title="hsvmoment.ito_mmnt.int_et"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_et()</span></code></a>,
is represented as a “polynomial” of following form</p>
<div class="math notranslate nohighlight">
\[\int_{(n-1)h}^t e^{ik[s-(n-1)h]} [s-(n-1)h]^j ds
 = \sum_{i,j^{'},l}c_{ij^{'}l}e^{ik[t-(n-1)h]}[t-(n-1)h]^{j^{'}}k^{-l}\]</div>
<p>which is encoded in a <a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, derived from
<a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.UserDict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.UserDict</span></code></a>, with
<code class="code docutils literal notranslate"><span class="pre">keyfor</span> <span class="pre">=</span> <span class="pre">('e^{k[t-(n-1)h]}','[t-(n-1)h]','k^{-}')</span></code>,
<code class="docutils literal notranslate"><span class="pre">key</span></code> = <span class="math notranslate nohighlight">\((i,j^{'},l)\)</span> and <code class="docutils literal notranslate"><span class="pre">value</span></code> = <span class="math notranslate nohighlight">\(c_{ij^{'}l}\)</span>.</p>
</section>
</section>
<section id="code-design">
<h3>Code Design<a class="headerlink" href="#code-design" title="Permalink to this heading">¶</a></h3>
<section id="ito-process-moment-i">
<h4>Itô process moment - I<a class="headerlink" href="#ito-process-moment-i" title="Permalink to this heading">¶</a></h4>
<p>With <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span> represented as 
a “polynomial” of following form</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\\
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{n_3k(n-1)h} e^{ik[t-(n-1)h]}
[t-(n-1)h]^jv_{n-1}^l k^{-o}\theta^p\sigma_v^q,\end{split}\]</div>
<p>consequently, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;e^{-kt}E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\\
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{(n_3-1)k(n-1)h}
e^{(i-1)k[t-(n-1)h]}[t-(n-1)h]^jv_{n-1}^l k^{-o}\theta^p\sigma_v^q,\\
&amp;e^{kt}E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\\
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{(n_3+1)k(n-1)h}
e^{(i+1)k[t-(n-1)h]}[t-(n-1)h]^jv_{n-1}^l k^{-o}\theta^p\sigma_v^q,\\
&amp;e^{2kt}E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\\
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{(n_3+2)k(n-1)h}
e^{(i+2)k[t-(n-1)h]}[t-(n-1)h]^jv_{n-1}^l k^{-o}\theta^p\sigma_v^q.\end{split}\]</div>
<p>Therefore, it’s profitable to consider following generic integral</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\int_{(n-1)h}^t e^{mks}E[eI_{n-1,s}^{n_3}I_{n-1,s}^{n_4}|v_{n-1}]ds\\ 
&amp;= \sum_{n_3,i,j,l,o,p,q} b_{n_3ijlopq} e^{(n_3+m)k(n-1)h} 
\cdot int\_et(i+m,j)\cdot v_{n-1}^l k^{-o}\theta^p\sigma_v^q\\
&amp;= \sum_{n_3+m,i+m,j^{'},l,o^{'},p,q} b_{(n_3+m)(i+m)j^{'}l o^{'}pq} 
e^{(n_3+m)k(n-1)h} e^{(i+m)k[t-(n-1)h]} [t-(n-1)h]^{j^{'}}\\
&amp;\qquad \cdot v_{n-1}^{l} k^{-o^{'}}\theta^{p}\sigma_v^{q}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[int\_et(i+m,j) 
=\sum_{i+m,j^{'},l^{'}} c_{(i+m)j^{'}l^{'}}e^{(i+m)k[t-(n-1)h]}
[t-(n-1)h]^{j^{'}} k^{-l^{'}}.\]</div>
<p>Implementation:</p>
<ol class="arabic simple">
<li><p>Function <a class="reference internal" href="#hsvmoment.ito_mmnt.int_meII" title="hsvmoment.ito_mmnt.int_meII"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_meII()</span></code></a> in module 
<a class="reference internal" href="generated/hsvmoment.ito_mmnt.html#module-hsvmoment.ito_mmnt" title="hsvmoment.ito_mmnt"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ito_mmnt</span></code></a> is defined to accomplish the computation in
equation <a class="reference internal" href="design.html#equation-int-meii">(2)</a>.</p></li>
<li><p>Function <a class="reference internal" href="#hsvmoment.ito_mmnt.recursive_eII" title="hsvmoment.ito_mmnt.recursive_eII"><code class="xref py py-func docutils literal notranslate"><span class="pre">recursive_eII()</span></code></a> in module
<a class="reference internal" href="generated/hsvmoment.ito_mmnt.html#module-hsvmoment.ito_mmnt" title="hsvmoment.ito_mmnt"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ito_mmnt</span></code></a> is defined to realize
the recursive step in equation <a class="reference internal" href="theory.html#equation-ito-moment-i">(3)</a> of <a class="reference internal" href="theory.html"><span class="doc">Theory</span></a>.</p></li>
<li><p>Function <a class="reference internal" href="#hsvmoment.ito_mmnt.moment_eII" title="hsvmoment.ito_mmnt.moment_eII"><code class="xref py py-func docutils literal notranslate"><span class="pre">moment_eII()</span></code></a> in module
<a class="reference internal" href="generated/hsvmoment.ito_mmnt.html#module-hsvmoment.ito_mmnt" title="hsvmoment.ito_mmnt"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ito_mmnt</span></code></a> is implemented to calculate
<span class="math notranslate nohighlight">\(E[eI_n^{n_3}I_n^{n_4}|v_{n-1}]\)</span>.</p></li>
</ol>
<p>For demonstration, I re-write the following initial three moments in
<a class="reference internal" href="theory.html#ito-recursive-i"><span class="std std-ref">Itô process Moment - I</span></a> in <a class="reference internal" href="theory.html"><span class="doc">Theory</span></a> according to the “polynomial”
representation</p>
<div class="math notranslate nohighlight">
\[\begin{split}E[eI_{n-1,t}^2|v_{n-1}]
&amp;=&amp; \frac{1}{2}&amp;e^{2k(n-1)h} e^{2k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0\\
&amp;&amp; + &amp;e^{2k(n-1)h}e^{k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^1
k^{-1}\theta^0\sigma_v^0\\
&amp;&amp; - &amp;e^{2k(n-1)h}e^{k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0\\
&amp;&amp; - &amp;e^{2k(n-1)h}e^{0k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^1
k^{-1}\theta^0\sigma_v^0\\
&amp;&amp; + \frac{1}{2} &amp;e^{2k(n-1)h}e^{0k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0,\\
%
E[eI_{n-1,t}I_{n-1,t}|v_{n-1}]
&amp;=&amp; &amp;e^{k(n-1)h} e^{k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0\\
&amp;&amp; +&amp;e^{k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^1v_{n-1}^1
k^{-0}\theta^0\sigma_v^0\\
&amp;&amp; -&amp;e^{k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^1v_{n-1}^0
k^{-0}\theta^1\sigma_v^0\\
&amp;&amp; -&amp;e^{k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0,\\
%
E[I_{n-1,t}^2|v_{n-1}]
&amp;=&amp;-&amp;e^{0k(n-1)h} e^{-k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^1
k^{-1}\theta^0\sigma_v^0\\
&amp;&amp; +&amp;e^{0k(n-1)h} e^{-k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0\\
&amp;&amp; +&amp;e^{0k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^1v_{n-1}^0
k^{-0}\theta^1\sigma_v^0\\
&amp;&amp; +&amp;e^{0k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^1
k^{-1}\theta^0\sigma_v^0\\
&amp;&amp; -&amp;e^{0k(n-1)h} e^{0k[t-(n-1)h]}[t-(n-1)h]^0v_{n-1}^0
k^{-1}\theta^1\sigma_v^0.\end{split}\]</div>
</section>
<section id="ito-process-moment-ii">
<h4>Itô process moment - II<a class="headerlink" href="#ito-process-moment-ii" title="Permalink to this heading">¶</a></h4>
<p>Implementation:</p>
<ol class="arabic simple">
<li><p>Define <a class="reference internal" href="#hsvmoment.ito_mmnt.int_meIII" title="hsvmoment.ito_mmnt.int_meIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_meIII()</span></code></a> similarly.</p></li>
<li><p>Define <a class="reference internal" href="#hsvmoment.ito_mmnt.recursive_eIII" title="hsvmoment.ito_mmnt.recursive_eIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">recursive_eIII()</span></code></a> to realize the 
recursive step in equation <a class="reference internal" href="theory.html#equation-ito-moment-ii">(4)</a> of <a class="reference internal" href="theory.html"><span class="doc">Theory</span></a>.</p></li>
<li><p>Define <a class="reference internal" href="#hsvmoment.ito_mmnt.moment_eIII" title="hsvmoment.ito_mmnt.moment_eIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">moment_eIII()</span></code></a> to finish the computation 
of  <span class="math notranslate nohighlight">\(E[eI_n^{n_3}I_n^{n_4}I_n^{*n_5}|v_{n-1}]\)</span>.</p></li>
</ol>
<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.c_nmi">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">c_nmi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.c_nmi" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficent <span class="math notranslate nohighlight">\(c_{nmi}\)</span> as in <a class="reference internal" href="design.html#equation-c-nmi">(1)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – n in <span class="math notranslate nohighlight">\(e^{nkt}\)</span>.</p></li>
<li><p><strong>m</strong> – m in <span class="math notranslate nohighlight">\(t^{m-i}\)</span>.</p></li>
<li><p><strong>i</strong> – i in <span class="math notranslate nohighlight">\(t^{m-i}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the coefficient <span class="math notranslate nohighlight">\(c_{nmi}\)</span>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fraction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.coef_poly">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">coef_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.coef_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply poly with different type coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef</strong> – Fraction.</p></li>
<li><p><strong>poly</strong> – poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p></li>
<li><p><strong>tp</strong> – <p>type of the multiplication,</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>tp</p></th>
<th class="head"><p>multiply with</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{k(n-1)h}v_{n-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(-e^{k(n-1)h}\theta\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\theta\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_v\)</span></p></td>
</tr>
</tbody>
</table>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.int_et">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">int_et</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.int_et" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(\int_{(n-1)h}^{t} e^{ik[s-(n-1)h]}[s-(n-1)h]^jds\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – i in <span class="math notranslate nohighlight">\(e^{ik[s-(n-1)h]}[s-(n-1)h]^j\)</span>.</p></li>
<li><p><strong>m</strong> – j in <span class="math notranslate nohighlight">\(e^{ik[s-(n-1)h]}[s-(n-1)h]^j\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘k^{-}’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.int_meII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">int_meII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.int_meII" title="Permalink to this definition">¶</a></dt>
<dd><p>Integral of <span class="math notranslate nohighlight">\(\int_{(n-1)h}^t e^{mks}eIIds\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – m in <span class="math notranslate nohighlight">\(\int_{(n-1)h}^t e^{mks}eIIds\)</span> where <span class="math notranslate nohighlight">\(eII\)</span> is 
<span class="math notranslate nohighlight">\(E[eI_{n-1,s}^{n_3}I_{n-1,s}^{n_4}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> in the integral.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> in the integral.</p></li>
<li><p><strong>eII</strong> – a dict with key (n3,n4) and value Poly object with attribute 
<code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.int_meIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">int_meIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eIII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.int_meIII" title="Permalink to this definition">¶</a></dt>
<dd><p>Integral of <span class="math notranslate nohighlight">\(\int_{(n-1)h}^t e^{mks}eIII ds\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – m in the integral where <span class="math notranslate nohighlight">\(eIII\)</span> is
<span class="math notranslate nohighlight">\(E[eI_{n-1,s}^{n_3}I_{n-1,s}^{n_4}I_{n-1,s}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> in the integral.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> in the integral.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(n_5\)</span> in the integral.</p></li>
<li><p><strong>eIII</strong> – a dict with key (n3,n4,n5) and value Poly object with 
attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, 
‘v_{n-1}’,’k^{-}’, ‘theta’, ‘sigma_v’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> =
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.moment_eII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">moment_eII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.moment_eII" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>return_pre</strong> – whether or not return lower order moments simultaneously,
default to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly if return_all=False else eII, where poly with attribute 
<code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’,’e^{k[t-(n-1)h]}’,’[t-(n-1)h]’,’v_{n-1}’,’k^{-}’,’theta’,
‘sigma_v’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a> or dict of Poly</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.moment_eIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">moment_eIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.moment_eIII" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(n_5\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>return_all</strong> – whether or not return lower order moments simultaneously,
default to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly if return_all=False else eIII, where poly with attribute 
<code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’,’e^{k[t-(n-1)h]}’,’[t-(n-1)h]’,’v_{n-1}’,’k^{-}’,’theta’,
‘sigma_v’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a> or dict of dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.moment_v">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">moment_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.moment_v" title="Permalink to this definition">¶</a></dt>
<dd><p>Moment of <span class="math notranslate nohighlight">\(v_{n-1}\)</span> as in equation <a class="reference internal" href="theory.html#equation-moment-v">(1)</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘theta’,’sigma_v^2/k’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.recursive_eII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">recursive_eII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.recursive_eII" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive step in equation <a class="reference internal" href="theory.html#equation-ito-moment-i">(3)</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>eII</strong> – a dict with key (n3,n4) and value Poly object with attribute 
<code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated eII.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.ito_mmnt.recursive_eIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.ito_mmnt.</span></span><span class="sig-name descname"><span class="pre">recursive_eIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eIII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.ito_mmnt.recursive_eIII" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive step in equation <a class="reference internal" href="theory.html#equation-ito-moment-ii">(4)</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n3</strong> – <span class="math notranslate nohighlight">\(n_3\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(n_4\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(n_5\)</span> 
in <span class="math notranslate nohighlight">\(E[eI_{n-1,t}^{n_3}I_{n-1,t}^{n_4}I_{n-1,t}^{*n_5}|v_{n-1}]\)</span>.</p></li>
<li><p><strong>eIII</strong> – a dict with key (n3,n4,n5) and value Poly object with attribute 
<code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘e^{k(n-1)h}’, ‘e^{k[t-(n-1)h]}’, ‘[t-(n-1)h]’, ‘v_{n-1}’,
‘k^{-}’, ‘theta’, ‘sigma_v’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated eIII.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
<hr class="docutils" />
<section id="module-hsvmoment.itos_mmnt">
<span id="two-srd"></span><h2>Two <abbr title="Square-Root Diffusions">SRD</abbr><a class="headerlink" href="#module-hsvmoment.itos_mmnt" title="Permalink to this heading">¶</a></h2>
<p>Itô process moment under Superposition of Two Square-Root Diffusion Processes</p>
<p>See <a class="reference internal" href="2fsv.html"><span class="doc">Two-Factor SV</span></a> for superposition of two square-root diffusion processes.
I will demonstrate how to compute</p>
<div class="math notranslate nohighlight" id="equation-eiieiii">
<span class="eqno">(1)<a class="headerlink" href="#equation-eiieiii" title="Permalink to this equation">¶</a></span>\[E[m_4m_5m_6m_7m_8]
\triangleq
E[eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7}
I_{n-1,t}^{*m_8}|v_{1,n-1},v_{2,n-1}].\]</div>
<section id="result">
<h3>Result<a class="headerlink" href="#result" title="Permalink to this heading">¶</a></h3>
<p>The result is presented first.
Function <a class="reference internal" href="#hsvmoment.itos_mmnt.moment_eIIeIII" title="hsvmoment.itos_mmnt.moment_eIIeIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">moment_eIIeIII()</span></code></a> is defined to compute 
equation <a class="reference internal" href="generated/hsvmoment.itos_mmnt.html#equation-eiieiii">(1)</a> which returns a <a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>
with attribute</p>
<p><code class="code docutils literal notranslate"><span class="pre">keyfor</span> <span class="pre">=</span> <span class="pre">('((n_1m,n_2m,i_m),...,(n_11,n_21,i_1))',</span> 
<span class="pre">'e^{(m_4*k1+m_6*k2)(n-1)h}','e^{(j_1*k1+j_2*k2)h}','h','v_{1,n-1}','theta1',</span>
<span class="pre">'sigma_v1','v_{2,n-1}','theta2','sigma_v2')</span></code>,</p>
<p>i.e., with key components standing for</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">key[0]</span></code>: <span class="math notranslate nohighlight">\(((n_{1m},n_{2m},i_{m}),...,(n_{11},n_{21},i_{1}))\)</span> for 
<span class="math notranslate nohighlight">\((n_{1m}k_1+n_{2m}k_2)^{-i_m}\cdots (n_{11}k_1+n_{21}k_2)^{-i_1}\)</span>,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">key[1]</span></code>: <span class="math notranslate nohighlight">\((m_4,m_6)\)</span> for <span class="math notranslate nohighlight">\(e^{(m_4k_1+m_6k_2)(n-1)h}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">key[2]</span></code>: <span class="math notranslate nohighlight">\((j_1,j_2)\)</span> for <span class="math notranslate nohighlight">\(e^{(j_1k_1+j_2k_2)[t-(n-1)h]}\)</span>,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">key[3]</span></code>: <span class="math notranslate nohighlight">\(i\)</span> for <span class="math notranslate nohighlight">\([t-(n-1)h]^i\)</span>,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">key[4],key[5],key[6]</span></code>: <span class="math notranslate nohighlight">\(v_{1,n-1}, \theta_1, \sigma_{v1}\)</span> 
raised to the respective power,</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">key[7],key[8],key[9]</span></code>: <span class="math notranslate nohighlight">\(v_{2,n-1}, \theta_2, \sigma_{v2}\)</span> 
raised to the respective power.</p></li>
</ul>
<p>Therefore, I write the result of equation <a class="reference internal" href="generated/hsvmoment.itos_mmnt.html#equation-eiieiii">(1)</a> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;E[m_4m_5m_6m_7m_8]\\
&amp;= \sum_{t0,(m_4,m_6),(i,i'),j,l,p,q,l',p',q'} 
b_{t0(m_4,m_6)(i,i')jlpql'p'q'} \cdot \\
&amp;\quad (n_{1m}k_1+n_{2m}k_2)^{-i_m} 
\cdots (n_{11}k_1+n_{21}k_2)^{-i_1}\cdot
e^{(m_4k_1+m_6k_2)(n-1)h}\cdot\\
&amp;\quad e^{(ik_1+i'k_2)[t-(n-1)h]} [t-(n-1)h]^{j}
v_{1,n-1}^{l}\theta_1^{p}\sigma_{v1}^{q} 
v_{2,n-1}^{l'}\theta_2^{p'}\sigma_{v2}^{q'}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(t0 = ((n_{1m},n_{2m},i_{m}),...,(n_{11},n_{21},i_{1}))\)</span>.</p>
<p><em>Note that</em> 
<span class="math notranslate nohighlight">\(E[eI_{1,n}^{m_4} I_{1,n}^{m_5} eI_{2,n}^{m_6} I_{2,n}^{m_7}
I_{n}^{*m_8}|v_{1,n-1},v_{2,n-1}] = E[m_4m_5m_6m_7m_8|_{t=nh}]\)</span>.</p>
<p>I will show the deduction process in what follows.</p>
</section>
<section id="deduction">
<h3>Deduction<a class="headerlink" href="#deduction" title="Permalink to this heading">¶</a></h3>
<p>In order to compute equation 
<a class="reference internal" href="generated/hsvmoment.itos_mmnt.html#equation-eiieiii">(1)</a>, I expand it by taking derivative as following</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;d(eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7}
I_{n-1,t}^{*m_8})\\
&amp;\approx \frac{1}{2}m_8(m_8-1)eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7}
I_{n-1,t}^{*m_8-2})v(t)dt\\
&amp;\quad + c_1(t) eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8} dt\\
&amp;\quad + c_2(t) eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} I_{n-1,t}^{*m_8} dt\\
&amp;\approx \frac{1}{2}m_8(m_8-1)eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8-2})v_1(t)dt\\
&amp;\quad + \frac{1}{2}m_8(m_8-1)eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8-2})v_2(t)dt\\
&amp;\quad + \frac{1}{2}m_4(m_4-1)e^{2k_1t}eI_{1,n-1,t}^{m_4-2}I_{1,n-1,t}^{m_5}eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8} v_1(t)dt\\
&amp;\quad + \frac{1}{2}m_5(m_5-1)eI_{1,n-1,t}^{m_4}  I_{1,n-1,t}^{m_5-2} eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8} v_1(t)dt\\
&amp;\quad + m_4m_5e^{k_1t}eI_{1,n-1,t}^{m_4-1}I_{1,n-1,t}^{m_5-1}eI_{2,n-1,t}^{m_6} I_{2,n-1,t}^{m_7} I_{n-1,t}^{*m_8} v_1(t)dt\\
&amp;\quad + \frac{1}{2}m_6(m_6-1)e^{2k_2t} eI_{2,n-1,t}^{m_6-2}I_{2,n-1,t}^{m_7}eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} I_{n-1,t}^{*m_8} v_2(t)dt\\
&amp;\quad + \frac{1}{2}m_7(m_7-1)eI_{2,n-1,t}^{m_6}  I_{2,n-1,t}^{m_7-2}eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} I_{n-1,t}^{*m_8} v_2(t)dt\\
&amp;\quad + m_6m_7e^{k_2t}eI_{2,n-1,t}^{m_6-1}I_{2,n-1,t}^{m_7-1}eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} I_{n-1,t}^{*m_8} v_2(t)dt\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}c_1(t)
&amp;\triangleq \bigg[
  \frac{1}{2}m_4(m_4-1)eI_{1,n-1,t}^{m_4-2}I_{1,n-1,t}^{m_5}e^{2k_1t} 
+ \frac{1}{2}m_5(m_5-1)eI_{1,n-1,t}^{m_4}  I_{1,n-1,t}^{m_5-2}\\
&amp;\qquad + m_4m_5eI_{1,n-1,t}^{m_4-1}I_{1,n-1,t}^{m_5-1}e^{k_1t} 
\bigg] v_1(t),\\
c_2(t)
&amp;\triangleq \bigg[
  \frac{1}{2}m_6(m_6-1)eI_{2,n-1,t}^{m_6-2}I_{2,n-1,t}^{m_7}e^{2k_2t} 
+ \frac{1}{2}m_7(m_7-1)eI_{2,n-1,t}^{m_6}  I_{2,n-1,t}^{m_7-2}\\
&amp;\qquad + m_6m_7eI_{2,n-1,t}^{m_6-1}I_{2,n-1,t}^{m_7-1}e^{k_2t} 
\bigg] v_2(t),\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}v_{1}(t) 
&amp;= e^{-k_1t}e^{k_1(n-1)h}(v_{1,n-1} - \theta_1) + \theta_1 + \sigma_{v1} e^{-k_1t}eI_{1,n-1,t},\\
v_{2}(t) 
&amp;= e^{-k_2t}e^{k_2(n-1)h}(v_{2,n-1} - \theta_2) + \theta_2 + \sigma_{v2} e^{-k_2t}eI_{2,n-1,t}.\end{split}\]</div>
</section>
<section id="recursive-equation">
<h3>Recursive Equation<a class="headerlink" href="#recursive-equation" title="Permalink to this heading">¶</a></h3>
<p>Thus, we have following <em>recursive equation</em></p>
<div class="math notranslate nohighlight" id="equation-ito-moment-m4m5m6m7m8">
<span class="eqno">(2)<a class="headerlink" href="#equation-ito-moment-m4m5m6m7m8" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;E[m_4m_5m_6m_7m_8]&amp;\\
&amp;= \frac{m_4(m_4-1)}{2}e^{k_1(n-1)h}(v_{1,n-1} - \theta_1) &amp;\int_{(n-1)h}^t e^{k_1s}E[(m_4-2)m_5m_6m_7m_8]ds\\
&amp;\quad + \frac{m_4(m_4-1)}{2}\theta_1 &amp;\int_{(n-1)h}^t e^{2k_1s}E[(m_4-2)m_5m_6m_7m_8]ds\\
&amp;\quad + \frac{m_4(m_4-1)}{2}\sigma_{v1} &amp;\int_{(n-1)h}^t e^{k_1s}E[(m_4-1)m_5m_6m_7m_8]ds\\
&amp;\quad + \frac{m_5(m_5-1)}{2}e^{k_1(n-1)h}(v_{1,n-1} - \theta_1) &amp;\color{blue}\int_{(n-1)h}^t e^{-k_1s}E[m_4(m_5-2)m_6m_7m_8]ds\\
&amp;\quad + \frac{m_5(m_5-1)}{2}\theta_1 &amp;\color{blue}\int_{(n-1)h}^t E[m_4(m_5-2)m_6m_7m_8]ds\\
&amp;\quad + \frac{m_5(m_5-1)}{2}\sigma_{v1} &amp;\color{blue}\int_{(n-1)h}^t e^{-k_1s}E[(m_4+1)(m_5-2)m_6m_7m_8]ds\\
&amp;\quad + m_4m_5e^{k_1(n-1)h}(v_{1,n-1} - \theta_1) &amp;\int_{(n-1)h}^t E[(m_4-1)(m_5-1)m_6m_7m_8]ds\\
&amp;\quad + m_4m_5\theta_1 &amp;\int_{(n-1)h}^t e^{k_1s}E[(m_4-1)(m_5-1)m_6m_7m_8]ds\\
&amp;\quad + m_4m_5\sigma_{v1} &amp;\int_{(n-1)h}^t E[m_4(m_5-1)m_6m_7m_8]ds\\
&amp;\quad + \frac{m_6(m_6-1)}{2}e^{k_2(n-1)h}(v_{2,n-1} - \theta_2) &amp;\color{blue}\int_{(n-1)h}^t e^{k_2s}E[m_4m_5(m_6-2)m_7m_8]ds\\
&amp;\quad + \frac{m_6(m_6-1)}{2}\theta_2 &amp;\color{blue}\int_{(n-1)h}^t e^{2k_2s}E[m_4m_5(m_6-2)m_7m_8]ds\\
&amp;\quad + \frac{m_6(m_6-1)}{2}\sigma_{v2} &amp;\color{blue}\int_{(n-1)h}^t e^{k_2s}E[m_4m_5(m_6-1)m_7m_8]ds\\
&amp;\quad + \frac{m_7(m_7-1)}{2}e^{k_2(n-1)h}(v_{2,n-1} - \theta_2) &amp;\int_{(n-1)h}^t e^{-k_2s}E[m_4m_5m_6(m_7-2)m_8]ds\\
&amp;\quad + \frac{m_7(m_7-1)}{2}\theta_2 &amp;\int_{(n-1)h}^t E[m_4m_5m_6(m_7-2)m_8]ds\\
&amp;\quad + \frac{m_7(m_7-1)}{2}\sigma_{v2} &amp;\int_{(n-1)h}^t e^{-k_2s}E[m_4m_5(m_6+1)(m_7-2)m_8]ds\\
&amp;\quad + m_6m_7e^{k_2(n-1)h}(v_{2,n-1} - \theta_2) &amp;\color{blue}\int_{(n-1)h}^t E[m_4m_5(m_6-1)(m_7-1)m_8]ds\\
&amp;\quad + m_6m_7\theta_2 &amp;\color{blue}\int_{(n-1)h}^t e^{k_2s}E[m_4m_5(m_6-1)(m_7-1)m_8]ds\\
&amp;\quad + m_6m_7\sigma_{v2} &amp;\color{blue}\int_{(n-1)h}^t E[m_4m_5m_6(m_7-1)m_8]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}e^{k_1(n-1)h}(v_{1,n-1} - \theta_1) &amp;\int_{(n-1)h}^t e^{-k_1s}E[m_4m_5m_6m_7(m_8-2)]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}\theta_1 &amp;\int_{(n-1)h}^t E[m_4m_5m_6m_7(m_8-2)]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}\sigma_{v1} &amp;\int_{(n-1)h}^t e^{-k_1s}E[(m_4+1)m_5m_6m_7(m_8-2)]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}e^{k_2(n-1)h}(v_{2,n-1} - \theta_2) &amp;\color{blue}\int_{(n-1)h}^t e^{-k_2s}E[m_4m_5m_6m_7(m_8-2)]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}\theta_2 &amp;\color{blue}\int_{(n-1)h}^t E[m_4m_5m_6m_7(m_8-2)]ds\\
&amp;\quad + \frac{m_8(m_8-1)}{2}\sigma_{v2} &amp;\color{blue}\int_{(n-1)h}^t e^{-k_2s}E[m_4m_5(m_6+1)m_7(m_8-2)]ds.\end{split}\]</div>
</section>
<section id="initial-moments">
<h3>Initial Moments<a class="headerlink" href="#initial-moments" title="Permalink to this heading">¶</a></h3>
<p>For order 0, i.e., <span class="math notranslate nohighlight">\(m_4+\cdots+m_8=0\)</span>, <span class="math notranslate nohighlight">\(E[m_4m_5m_6m_7m_8] = 1\)</span>. 
And for order 1, <span class="math notranslate nohighlight">\(m_4+\cdots+m_8=1\)</span>, <span class="math notranslate nohighlight">\(E[m_4m_5m_6m_7m_8] = 0\)</span>.</p>
<p>For order 2, i.e., <span class="math notranslate nohighlight">\(m_4+\cdots+m_8=2\)</span>, <span class="math notranslate nohighlight">\(E[m_4m_5m_6m_7m_8] = 0\)</span>,
except for</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(m_4+m_5=2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;E[eI_{1,n-1,t}^2|v_{1,n-1}]\\
&amp;= e^{2k_1t}\frac{1}{2k_1}\theta_1 + e^{k_1t + k_1(n-1)h}\frac{1}{k_1}
(v_{1,n-1}-\theta_1) - e^{2k_1(n-1)h}\frac{1}{2k_1}\left(2v_{1,n-1}
- \theta_1 \right),\\
%
&amp;E[eI_{1,n-1,t}I_{1,n-1,t}|v_{1,n-1}]\\
&amp;=e^{k_1t}\frac{1}{k_1}\theta_1 
  + e^{k_1(n-1)h}(v_{1,n-1}-\theta_1)[t-(n-1)h]
  - e^{k_1(n-1)h}\frac{1}{k_1}\theta_1,\\
%
&amp;E[I_{1,n-1,t}^2|v_{1,n-1}]\\
&amp;= -e^{-k_1t + k_1(n-1)h}\frac{1}{k_1}(v_{1,n-1}-\theta_1) 
  + \theta_1[t-(n-1)h] + (v_{1,n-1}-\theta_1)\frac{1}{k_1};\end{split}\]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(m_6+m_7=2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;E[eI_{2,n-1,t}^2|v_{2,n-1}]\\
&amp;= e^{2k_2t}\frac{1}{2k_2}\theta_2 + e^{k_2t + k_2(n-1)h}\frac{1}{k_2}
(v_{2,n-1}-\theta_2) - e^{2k_2(n-1)h}\frac{1}{2k_2}\left(2v_{2,n-1}
- \theta_2 \right),\\
%
&amp;E[eI_{2,n-1,t}I_{2,n-1,t}|v_{2,n-1}]\\
&amp;=e^{k_2t}\frac{1}{k_2}\theta_2 
  + e^{k_2(n-1)h}(v_{2,n-1}-\theta_2)[t-(n-1)h]
- e^{k_2(n-1)h}\frac{1}{k_2}\theta_2,\\
%
&amp;E[I_{2,n-1,t}^2|v_{2,n-1}]\\
&amp;= -e^{-k_2t + k_2(n-1)h}\frac{1}{k_2}(v_{2,n-1}-\theta_2) 
   + \theta_2[t-(n-1)h] + (v_{2,n-1}-\theta_2)\frac{1}{k_2};\end{split}\]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(m_8=2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;E[I_{n-1,t}^{*2}|v_{1,n-1},v_{2,n-1}]\\
&amp;= -e^{k_1(n-1)h}(v_{1,n-1}-\theta_1)\frac{1}{k_1}(e^{-k_1t} - 
e^{-k_1(n-1)h}) +\theta_1 [t-(n-1)h]\\
&amp;\quad -e^{k_2(n-1)h}(v_{2,n-1}-\theta_2)\frac{1}{k_2}(e^{-k_2t} - 
e^{-k_2(n-1)h}) +\theta_2 [t-(n-1)h].\end{split}\]</div>
</li>
</ul>
</section>
<section id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">¶</a></h3>
<p>We have <a class="footnote-reference brackets" href="#f1" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int e^{(n_1k_1+n_2k_2)t} t^m dt =
\begin{cases}
\sum_{i=0}^m c_{n_1n_2mi} e^{(n_1k_1+n_2k_2)t} t^{m-i} &amp; \text{if } n_1k_1+n_2k_2\neq 0, m \neq 0,\\
\frac{1}{n_1k_1+n_2k_2}e^{(n_1k_1+n_2k_2)t}t^0 &amp; \text{if } n_1k_1+n_2k_2\neq 0, m = 0,\\
\frac{1}{m+1}e^{0kt}t^{m+1} &amp; \text{if } n_1k_1+n_2k_2 = 0, m \neq 0,\\
e^{0kt}t^1 &amp; \text{if } n_1k_1+n_2k_2 =0 , m=0,
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_{n_1n_2m0} \triangleq \frac{1}{n_1k_1+n_2k_2}\)</span> and</p>
<div class="math notranslate nohighlight" id="equation-c-n-1n-2mi">
<span class="eqno">(3)<a class="headerlink" href="#equation-c-n-1n-2mi" title="Permalink to this equation">¶</a></span>\[c_{n_1n_2mi} \triangleq \frac{(-1)^{i}}{(n_1k_1+n_2k_2)^{i+1}} 
\prod_{j=m-i+1}^{m} j,~~ 1\le i \le m.\]</div>
<p>The coefficient <span class="math notranslate nohighlight">\(c_{n_1n_2mi}\)</span> is implemented in function
<a class="reference internal" href="#hsvmoment.itos_mmnt.c" title="hsvmoment.itos_mmnt.c"><code class="xref py py-func docutils literal notranslate"><span class="pre">c()</span></code></a>.</p>
<p>For the definite integral</p>
<div class="math notranslate nohighlight">
\[\int_{(n-1)h}^t e^{(n_1k_1+n_2k_2)[s-(n-1)h]}[s-(n-1)h]^mds 
= F(t-(n-1)h) - F(0)\]</div>
<p>which is defined in <a class="reference internal" href="#hsvmoment.itos_mmnt.int_et" title="hsvmoment.itos_mmnt.int_et"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_et()</span></code></a>,
where <span class="math notranslate nohighlight">\(F(t) = \int e^{(n_1k_1+n_2k_2)t} t^m dt\)</span>.</p>
<p>In summary, I defined</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#hsvmoment.itos_mmnt.int_et" title="hsvmoment.itos_mmnt.int_et"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_et()</span></code></a> which uses 
<a class="reference internal" href="#hsvmoment.itos_mmnt.c" title="hsvmoment.itos_mmnt.c"><code class="xref py py-func docutils literal notranslate"><span class="pre">c()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hsvmoment.itos_mmnt.recursive_eIIeIII" title="hsvmoment.itos_mmnt.recursive_eIIeIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">recursive_eIIeIII()</span></code></a> which uses
<a class="reference internal" href="#hsvmoment.itos_mmnt.int_meIIeIII" title="hsvmoment.itos_mmnt.int_meIIeIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_meIIeIII()</span></code></a> and
<a class="reference internal" href="#hsvmoment.itos_mmnt.coef_poly" title="hsvmoment.itos_mmnt.coef_poly"><code class="xref py py-func docutils literal notranslate"><span class="pre">coef_poly()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hsvmoment.itos_mmnt.moment_eIIeIII" title="hsvmoment.itos_mmnt.moment_eIIeIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">moment_eIIeIII()</span></code></a>.</p></li>
</ol>
<hr class="docutils" />
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>It’s assumed <span class="math notranslate nohighlight">\(n_1k_1 + n_2k_2\neq 0\)</span>.</p>
</aside>
<hr class="docutils" />
<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.c">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.c" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant <span class="math notranslate nohighlight">\(c_{n_1n_2mi}\)</span> in <a class="reference internal" href="generated/hsvmoment.itos_mmnt.html#equation-c-n-1n-2mi">(3)</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n1</strong> – <span class="math notranslate nohighlight">\(n_1\)</span> in <span class="math notranslate nohighlight">\(\int_{(n-1)h}^t e^{(n_1k_1+n_2k_2)s}s^mds\)</span>.</p></li>
<li><p><strong>n2</strong> – <span class="math notranslate nohighlight">\(n_2\)</span> in above integral.</p></li>
<li><p><strong>m</strong> – <span class="math notranslate nohighlight">\(m\)</span> in above integral.</p></li>
<li><p><strong>i</strong> – <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(t^{m-i}\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of (key,val) with key for <span class="math notranslate nohighlight">\((n_1,n_2,i)\)</span> in 
<span class="math notranslate nohighlight">\((n_1k_1+n_2k_2)^{-i}\)</span>, val for the value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.coef_poly">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">coef_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.coef_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply poly with different type coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef</strong> – integer, such as the leading <span class="math notranslate nohighlight">\(m_4(m_4-1)/2\)</span>.</p></li>
<li><p><strong>poly</strong> – poly returned by <a class="reference internal" href="#hsvmoment.itos_mmnt.int_meIIeIII" title="hsvmoment.itos_mmnt.int_meIIeIII"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_meIIeIII()</span></code></a>.</p></li>
<li><p><strong>tp</strong> – <p>type of the multiplication,</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>tp</p></th>
<th class="head"><p>multiply with</p></th>
<th class="head"><p>tp</p></th>
<th class="head"><p>multiply with</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{k_1(n-1)h}v_{1,n-1}\)</span></p></td>
<td><p>5</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{k_2(n-1)h}v_{2,n-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(-e^{k_1(n-1)h}\theta_1\)</span></p></td>
<td><p>6</p></td>
<td><p><span class="math notranslate nohighlight">\(-e^{k_2(n-1)h}\theta_2\)</span></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\theta_1\)</span></p></td>
<td><p>7</p></td>
<td><p><span class="math notranslate nohighlight">\(\theta_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_{v1}\)</span></p></td>
<td><p>8</p></td>
<td><p><span class="math notranslate nohighlight">\(\sigma_{v2}\)</span></p></td>
</tr>
</tbody>
</table>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’,
‘e^{(m_4*k1+m_6*k2)(n-1)h}’,’e^{(j_1*k1+j_2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’,
‘v_{1,n-1}’,’theta1’,’sigma_v1’, ‘v_{2,n-1}’,’theta2’,’sigma_v2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.int_et">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">int_et</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.int_et" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(\int_{(n-1)h}^t e^{(n_1k_1+n_2k_2)[s-(n-1)h]}[s-(n-1)h]^mds\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n1</strong> – <span class="math notranslate nohighlight">\(n_1\)</span> in above integral.</p></li>
<li><p><strong>n2</strong> – <span class="math notranslate nohighlight">\(n_2\)</span> in above integral.</p></li>
<li><p><strong>m</strong> – <span class="math notranslate nohighlight">\(m\)</span> in above integral.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> =
(‘(n1*k1+n2*k2)^{-}’,’e^{(n1*k1+n2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.int_meIIeIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">int_meIIeIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eIIeIII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.int_meIIeIII" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(\int_{(n-1)h}^te^{mk_is}E[n_4n_5n_6n_7n_8]ds\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(e^{mk_is} (i=1,2)\)</span>.</p></li>
<li><p><strong>m</strong> – <span class="math notranslate nohighlight">\(m\)</span> in <span class="math notranslate nohighlight">\(e^{mk_is} (i=1,2)\)</span>.</p></li>
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(m_4\)</span> in <span class="math notranslate nohighlight">\(eI_{1,n-1,t}^{m_4}\)</span>.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(m_5\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{m_5}\)</span>.</p></li>
<li><p><strong>n6</strong> – <span class="math notranslate nohighlight">\(m_6\)</span> in <span class="math notranslate nohighlight">\(eI_{2,n-1,t}^{m_6}\)</span>.</p></li>
<li><p><strong>n7</strong> – <span class="math notranslate nohighlight">\(m_7\)</span> in <span class="math notranslate nohighlight">\(I_{2,n-1,t}^{m_7}\)</span>.</p></li>
<li><p><strong>n8</strong> – <span class="math notranslate nohighlight">\(m_8\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{*m_8}\)</span>.</p></li>
<li><p><strong>eIIeIII</strong> – a dict with key (n4,n5,n6,n7,n8) and value poly with 
attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’,
‘e^{(m_4*k1+m_6*k2)(n-1)h}’,’e^{(j_1*k1+j_2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’,
‘v_{1,n-1}’,’theta1’,’sigma_v1’, ‘v_{2,n-1}’,’theta2’,’sigma_v2’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’,
‘e^{(m_4*k1+m_6*k2)(n-1)h}’,’e^{(j_1*k1+j_2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’,
‘v_{1,n-1}’,’theta1’,’sigma_v1’, ‘v_{2,n-1}’,’theta2’,’sigma_v2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.moment_eIIeIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">moment_eIIeIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.moment_eIIeIII" title="Permalink to this definition">¶</a></dt>
<dd><p>Moment of <span class="math notranslate nohighlight">\(E[m_4m_5m_6m_7m_8]\)</span></p>
<p>Moment of the combination of Ito processes, conditioning on the previous 
volatility components, i.e.,</p>
<div class="math notranslate nohighlight">
\[E[eI_{1,n-1,t}^{m_4} I_{1,n-1,t}^{m_5} eI_{2,n-1,t}^{m_6} 
I_{2,n-1,t}^{m_7}I_{n-1,t}^{*m_8}|v_{1,n-1},v_{2,n-1}]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(m_4\)</span> in <span class="math notranslate nohighlight">\(eI_{1,n-1,t}^{m_4}\)</span>.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(m_5\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{m_5}\)</span>.</p></li>
<li><p><strong>n6</strong> – <span class="math notranslate nohighlight">\(m_6\)</span> in <span class="math notranslate nohighlight">\(eI_{2,n-1,t}^{m_6}\)</span>.</p></li>
<li><p><strong>n7</strong> – <span class="math notranslate nohighlight">\(m_7\)</span> in <span class="math notranslate nohighlight">\(I_{2,n-1,t}^{m_7}\)</span>.</p></li>
<li><p><strong>n8</strong> – <span class="math notranslate nohighlight">\(m_8\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{*m_8}\)</span>.</p></li>
<li><p><strong>return_all</strong> – whether or not return lower order moments simultaneously,
defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly if return_all=False else eIIeIII</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a> or dict of Poly</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.recursive_eIIeIII">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">recursive_eIIeIII</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eIIeIII</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.recursive_eIIeIII" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive equation <a class="reference internal" href="generated/hsvmoment.itos_mmnt.html#equation-ito-moment-m4m5m6m7m8">(2)</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n4</strong> – <span class="math notranslate nohighlight">\(m_4\)</span> in <span class="math notranslate nohighlight">\(eI_{1,n-1,t}^{m_4}\)</span>.</p></li>
<li><p><strong>n5</strong> – <span class="math notranslate nohighlight">\(m_5\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{m_5}\)</span>.</p></li>
<li><p><strong>n6</strong> – <span class="math notranslate nohighlight">\(m_6\)</span> in <span class="math notranslate nohighlight">\(eI_{2,n-1,t}^{m_6}\)</span>.</p></li>
<li><p><strong>n7</strong> – <span class="math notranslate nohighlight">\(m_7\)</span> in <span class="math notranslate nohighlight">\(I_{2,n-1,t}^{m_7}\)</span>.</p></li>
<li><p><strong>n8</strong> – <span class="math notranslate nohighlight">\(m_8\)</span> in <span class="math notranslate nohighlight">\(I_{1,n-1,t}^{*m_8}\)</span>.</p></li>
<li><p><strong>eIIeIII</strong> – a dict with key (n4,n5,n6,n7,n8) and value poly with 
attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’,
‘e^{(m_4*k1+m_6*k2)(n-1)h}’,’e^{(j_1*k1+j_2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’,
‘v_{1,n-1}’,’theta1’,’sigma_v1’, ‘v_{2,n-1}’,’theta2’,’sigma_v2’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = 
(‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’,
‘e^{(m_4*k1+m_6*k2)(n-1)h}’,’e^{(j_1*k1+j_2*k2)[t-(n-1)h]}’,’[t-(n-1)h]’,
‘v_{1,n-1}’,’theta1’,’sigma_v1’, ‘v_{2,n-1}’,’theta2’,’sigma_v2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.itos_mmnt.t_mul_t0">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.itos_mmnt.</span></span><span class="sig-name descname"><span class="pre">t_mul_t0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.itos_mmnt.t_mul_t0" title="Permalink to this definition">¶</a></dt>
<dd><p>multiply quant t0 with quant t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – a tuple (n1,n2,i) standing for ‘(n1*k1+n2*k2)^{-i}’.</p></li>
<li><p><strong>t0</strong> – a tuple of tuple, 
‘(n_1m*k1+n_2m*k2)^{-i_m},…,(n_11*k1+n_21*k2)^{-i_1}’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a tuple of tuple.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<hr class="docutils" />
<section id="module-hsvmoment.cpp_mmnt">
<span id="cpp"></span><h2><abbr title="Compound Poisson Process">CPP</abbr><a class="headerlink" href="#module-hsvmoment.cpp_mmnt" title="Permalink to this heading">¶</a></h2>
<p>Compound Poisson Process variable moments</p>
<p>Compound Poisson Process</p>
<div class="math notranslate nohighlight">
\[J(t) = \sum_{i=0}^{N(t)}j_i,\quad j_i \sim \mathcal{N}(\mu_j,\sigma_j^2)\]</div>
<p>where <span class="math notranslate nohighlight">\(N(t)\)</span> is a Poisson process with rate <span class="math notranslate nohighlight">\(\lambda\)</span>.
For our interest, I define variable 
<span class="math notranslate nohighlight">\(J_n = \sum_{i=N((n-1)h)+1}^{N(nh)}j_i\)</span>.</p>
<section id="moment-generating-function">
<h3>Moment-Generating Function<a class="headerlink" href="#moment-generating-function" title="Permalink to this heading">¶</a></h3>
<p>For variable <span class="math notranslate nohighlight">\(J_n\)</span>, its moment-generating function</p>
<div class="math notranslate nohighlight">
\[M_{J_n}(s) = e^{\lambda h (M_{j_i}(s)-1)},
\qquad
M_{j_i}(s) = e^{\mu_js+\frac{1}{2}\sigma_j^2s^2}.\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{j_i}(s)\)</span> is the moment-generating function of normal variable
<span class="math notranslate nohighlight">\(j_i\)</span>.</p>
<section id="mgf-cpp">
<h4>MGF - <abbr title="Compound Poisson Process">CPP</abbr><a class="headerlink" href="#mgf-cpp" title="Permalink to this heading">¶</a></h4>
<p>For the first three derivatives,</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_{J_n}^{'}(s) 
&amp;= e^{\lambda h (M_{j_i}(s)-1)} (\lambda h) M_{j_i}^{'}(s),\\
M_{J_n}^{''}(s)
&amp;= e^{\lambda h (M_{j_i}(s)-1)} \left[ (\lambda h)^2 M_{j_i}^{'2}(s)
+ (\lambda h) M_{j_i}^{''}(s) \right],\\
M_{J_n}^{(3)}(s)
&amp;= e^{\lambda h (M_{j_i}(s)-1)} \left[ (\lambda h)^3 M_{j_i}^{'3}(s)
+ 3(\lambda h)^2 M_{j_i}^{'}(s) M_{j_i}^{''}(s) 
+ (\lambda h) M_{j_i}^{(3)}(s) \right].\end{split}\]</div>
<p>I propose to represent derivative of any order as</p>
<div class="math notranslate nohighlight">
\[M^{(n)}_{J_n}(s)
= \sum_{(i,(n1,m1),...,(nl,ml))} b_{key} (\lambda h)^i M_{j_i}^{(n1)m1}(s)
\cdots M_{j_i}^{(nl)ml}(s)\]</div>
<p>where <span class="math notranslate nohighlight">\(n1 &lt; \cdots &lt; nl\)</span> and <span class="math notranslate nohighlight">\(key=(i,(n1,m1),...,(nl,ml))\)</span>.
Then its derivative goes as</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_{J_n}^{(n+1)}(s)
&amp;= \sum_{(i,(n1,m1),...,(nl,ml))} b_{key} (\lambda h)^{i+1} M_{j_i}^{(1)}(s)
M_{j_i}^{(n1)m1}(s)\cdots M_{j_i}^{(nl)ml}(s)\\
&amp;\quad+ \sum_{(i,(n1,m1),...,(nl,ml))} b_{key} (\lambda h)^i 
(M_{j_i}^{(n1)m1}(s)\cdots M_{j_i}^{(nl)ml}(s))'.\end{split}\]</div>
<p>Rearrage the derivative to represent it as that of <span class="math notranslate nohighlight">\(M^{(n)}_{J_n}(s)\)</span>.</p>
</section>
<section id="mgf-normal-distribution">
<h4>MGF - Normal Distribution<a class="headerlink" href="#mgf-normal-distribution" title="Permalink to this heading">¶</a></h4>
<p>For the first three derivatives,</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_{j_i}^{'}(s)
&amp;= e^{\mu_js+\frac{1}{2}\sigma_j^2s^2} (\mu_j + \sigma_j^2s),\\
M_{j_i}^{''}(s)
&amp;= e^{\mu_js+\frac{1}{2}\sigma_j^2s^2} \left[ (\mu_j + \sigma_j^2s)^2
+  \sigma_j^2 \right],\\
M_{j_i}^{(3)}(s)
&amp;= e^{\mu_js+\frac{1}{2}\sigma_j^2s^2} \left[ (\mu_j + \sigma_j^2s)^3
+  (\mu_j + \sigma_j^2s)\sigma_j^2 + 
2(\mu_j + \sigma_j^2s)\sigma_j^2\right].\end{split}\]</div>
<p>I propose to represent derivative of any order as</p>
<div class="math notranslate nohighlight">
\[M_{j_i}^{(n)}(s)
= \sum_{i,j}b_{ij}(\mu+\sigma^2s)^i \sigma^{2j}.\]</div>
<p>Then its derivative is given as</p>
<div class="math notranslate nohighlight">
\[M_{j_i}^{(n+1)}(s)
= \sum_{i,j}b_{ij}(\mu+\sigma^2s)^{i+1} \sigma^{2j}
 +\sum_{i&gt;0,j}b_{ij}i(\mu+\sigma^2s)^{i-1} \sigma^{2(j+1)}.\]</div>
<p>Rearrage the derivative to represent it as that of <span class="math notranslate nohighlight">\(M^{(n)}_{j_i}(s)\)</span>.</p>
<p>In summary, I defined</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#hsvmoment.cpp_mmnt.mnorm" title="hsvmoment.cpp_mmnt.mnorm"><code class="xref py py-func docutils literal notranslate"><span class="pre">mnorm()</span></code></a> to compute moment of normal variable
which uses 
<a class="reference internal" href="#hsvmoment.cpp_mmnt.dmgf" title="hsvmoment.cpp_mmnt.dmgf"><code class="xref py py-func docutils literal notranslate"><span class="pre">dmgf()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hsvmoment.cpp_mmnt.mcpp" title="hsvmoment.cpp_mmnt.mcpp"><code class="xref py py-func docutils literal notranslate"><span class="pre">mcpp()</span></code></a> to compute moment of CPP variable
which uses
<a class="reference internal" href="#hsvmoment.cpp_mmnt.dmgf_cpp" title="hsvmoment.cpp_mmnt.dmgf_cpp"><code class="xref py py-func docutils literal notranslate"><span class="pre">dmgf_cpp()</span></code></a>, 
<a class="reference internal" href="#hsvmoment.cpp_mmnt.decode" title="hsvmoment.cpp_mmnt.decode"><code class="xref py py-func docutils literal notranslate"><span class="pre">decode()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#hsvmoment.cpp_mmnt.cmcpp" title="hsvmoment.cpp_mmnt.cmcpp"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmcpp()</span></code></a> to compute central moment of CPP
variable.</p></li>
</ol>
<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.cmcpp">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">cmcpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.cmcpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Central Moment of Compound Poisson Process of order n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘lambda*h’,’mu’,’sigma^2’)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.d1_times_key">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">d1_times_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.d1_times_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the key after multiply with <span class="math notranslate nohighlight">\((\lambda h)M_{j_i}'(s)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> – a tuple of (i,(n1,m1),…,(nl,ml)) which
stands for <span class="math notranslate nohighlight">\((\lambda h)^{i} M^{(n_1)m_1}(s) ... M^{(n_l)m_l}(s)\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.decode">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">decode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode intermediate poly to target poly</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>poly</strong> – poly representation of MGF with 
key <span class="math notranslate nohighlight">\((i,(n_1,m_1),...,(n_l,m_l))\)</span> which
stands for <span class="math notranslate nohighlight">\((\lambda h)^{i} M^{(n_1)m_1}(s) ... M^{(n_l)m_l}(s)\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘lambda*h’,’mu’,’sigma^2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.dmgf">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">dmgf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.dmgf" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of normal Moment-Generating Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>poly</strong> – poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘mu’,’sigma^2’).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘mu’,’sigma^2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.dmgf_cpp">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">dmgf_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.dmgf_cpp" title="Permalink to this definition">¶</a></dt>
<dd><p>derivative of Moment Generating Function of CPP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>poly</strong> – poly representing MGF with 
key <span class="math notranslate nohighlight">\((i,(n_1,m_1),...,(n_l,m_l))\)</span> which
stands for <span class="math notranslate nohighlight">\((\lambda h)^{i}M^{(n_1)m_1}(s) ... M^{(n_l)m_l}(s)\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with the same key-val.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.dterm">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">dterm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.dterm" title="Permalink to this definition">¶</a></dt>
<dd><p>Take derivative of each term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – key corresponding to a term, i.e.,
(i,(n1,m1),(n2,m2),…,(nj,mj)) which
stands for <span class="math notranslate nohighlight">\((\lambda h)^{i} M^{(n_1)m_1}(s) ... M^{(n_l)m_l}(s)\)</span>.</p></li>
<li><p><strong>coef</strong> – corresponding coefficient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly representing the derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.mcpp">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">mcpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.mcpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Moment of Compound Poisson Process variable of order n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘lambda*h’,’mu’,’sigma^2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.merge">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge two dict poly</p>
<p>Insert new key-value or add value for the existing key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> – poly.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a new poly.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.mnorm">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">mnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.mnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Moment of Normal distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – order of the moment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘mu’,’sigma^2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsvmoment.cpp_mmnt.poly_pow">
<span class="sig-prename descclassname"><span class="pre">hsvmoment.cpp_mmnt.</span></span><span class="sig-name descname"><span class="pre">poly_pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">poly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hsvmoment.cpp_mmnt.poly_pow" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise poly to power n</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly</strong> – poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘mu’,’sigma^2’).</p></li>
<li><p><strong>n</strong> – power.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>poly with attribute <code class="docutils literal notranslate"><span class="pre">keyfor</span></code> = (‘mu’,’sigma^2’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hsvmoment.poly.Poly" title="hsvmoment.poly.Poly">Poly</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">hsvmoment</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Program Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks.html">Building Blocks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building Blocks API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-hsvmoment.poly">Class Poly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hsvmoment.ito_mmnt">One <abbr title="Square-Root Diffusion">SRD</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hsvmoment.itos_mmnt">Two <abbr title="Square-Root Diffusions">SRD</abbr></a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hsvmoment.cpp_mmnt"><abbr title="Compound Poisson Process">CPP</abbr></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1fsv.html">One-Factor SV</a></li>
<li class="toctree-l1"><a class="reference internal" href="1fsvj.html">One-Factor SV with jump</a></li>
<li class="toctree-l1"><a class="reference internal" href="2fsv.html">Two-Factor SV</a></li>
<li class="toctree-l1"><a class="reference internal" href="2fsvj.html">Two-Factor SV with jump</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="generated/hsvmoment.cpp_mmnt.html" title="previous chapter">hsvmoment.cpp_mmnt</a></li>
      <li>Next: <a href="1fsv.html" title="next chapter">One-Factor SV</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Yanfeng Wu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>